{% extends 'base.html.twig' %}

{% block title %}Edit Quiz - {{ quiz.title }}{% endblock %}

{% block body %}
<style>
    .quiz-form { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .form-group { margin-bottom: 1em; }
    .form-group label { display: block; font-weight: bold; margin-bottom: 0.25em; }
    .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 0.5em; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
    .form-group textarea { min-height: 100px; }
    .checkbox-group { display: flex; align-items: center; gap: 0.5em; }
    .checkbox-group input { width: auto; }
    .btn { display: inline-block; padding: 0.5em 1em; background: #007bff; color: white; text-decoration: none; border-radius: 4px; margin-right: 0.5em; border: none; cursor: pointer; }
    .btn-secondary { background: #6c757d; }
    .collection-item { border: 1px solid #ddd; padding: 1em; margin-bottom: 1em; border-radius: 4px; background: #f9f9f9; }
    .nested-collection { border: 1px solid #ccc; padding: 0.5em; margin: 0.5em 0; border-radius: 4px; background: #fff; }
</style>

<div class="quiz-form">
    <h1>Edit Quiz: {{ quiz.title }}</h1>

    {{ form_start(form) }}
        <div class="form-group">
            {{ form_label(form.title) }}
            {{ form_widget(form.title) }}
            {{ form_errors(form.title) }}
        </div>

        <div class="form-group">
            {{ form_label(form.description) }}
            {{ form_widget(form.description) }}
            {{ form_errors(form.description) }}
        </div>

        <div class="form-group">
            {{ form_label(form.category) }}
            {{ form_widget(form.category) }}
            {{ form_errors(form.category) }}
        </div>

        <div class="form-group">
            {{ form_label(form.difficulty) }}
            {{ form_widget(form.difficulty) }}
            {{ form_errors(form.difficulty) }}
        </div>

        <div class="form-group checkbox-group">
            {{ form_widget(form.isPublic) }}
            {{ form_label(form.isPublic) }}
            {{ form_errors(form.isPublic) }}
        </div>

        <div class="form-group checkbox-group">
            {{ form_widget(form.isActive) }}
            {{ form_label(form.isActive) }}
            {{ form_errors(form.isActive) }}
        </div>

        <h2>Questions</h2>
        <div class="questions-collection" data-prototype="{{ form_widget(form.questions.vars.prototype)|e('html_attr') }}">
            {% for question in form.questions %}
                <div class="collection-item question-item">
                    {{ form_row(question.text) }}
                    {{ form_row(question.questionType) }}
                    {{ form_row(question.points) }}
                    {{ form_row(question.timeLimit) }}
                    {{ form_row(question.mediaUrl) }}
                    
                    <h4>Answers</h4>
                    <div class="answers-collection" data-prototype="{{ form_widget(question.answers.vars.prototype)|e('html_attr') }}">
                        {% for answer in question.answers %}
                            <div class="nested-collection answer-item">
                                {{ form_row(answer.text) }}
                                {{ form_row(answer.isCorrect) }}
                                {{ form_row(answer.orderIndex) }}
                            </div>
                        {% endfor %}
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="form-group">
            <button type="submit" class="btn">Update Quiz</button>
            <a href="{{ path('app_quiz_show', {id: quiz.id}) }}" class="btn btn-secondary">Cancel</a>
        </div>
    {{ form_end(form) }}
</div>
{% endblock %}
