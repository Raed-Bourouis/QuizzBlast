{% extends 'base.html.twig' %}

{% block title %}{{ quiz.title }}{% endblock %}

{% block body %}
<style>
    .quiz-detail { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .quiz-header { border-bottom: 2px solid #ddd; padding-bottom: 1em; margin-bottom: 1em; }
    .quiz-meta { color: #666; font-size: 0.9em; }
    .question-card { border: 1px solid #ddd; padding: 1em; margin-bottom: 1em; border-radius: 8px; }
    .question-card h3 { margin-top: 0; }
    .answer-list { list-style: none; padding: 0; }
    .answer-item { padding: 0.5em; margin: 0.25em 0; background: #f9f9f9; border-radius: 4px; }
    .answer-item.correct { background: #d4edda; border: 1px solid #c3e6cb; }
    .btn { display: inline-block; padding: 0.5em 1em; background: #007bff; color: white; text-decoration: none; border-radius: 4px; margin-right: 0.5em; border: none; cursor: pointer; }
    .btn-secondary { background: #6c757d; }
    .btn-warning { background: #ffc107; color: #212529; }
    .btn-danger { background: #dc3545; }
</style>

<div class="quiz-detail">
    <div class="quiz-header">
        <h1>{{ quiz.title }}</h1>
        <p>{{ quiz.description }}</p>
        <p class="quiz-meta">
            Category: {{ quiz.category }} | 
            Difficulty: {{ quiz.difficulty }} |
            Questions: {{ quiz.questions|length }} |
            Created: {{ quiz.createdAt|date('Y-m-d H:i') }}
        </p>
        
        <p>
            <a href="{{ path('app_quiz_index') }}" class="btn btn-secondary">Back to Quizzes</a>
            {% if is_granted('ROLE_USER') and app.user == quiz.createdBy %}
                <a href="{{ path('app_quiz_edit', {id: quiz.id}) }}" class="btn btn-warning">Edit</a>
                <form method="post" action="{{ path('app_quiz_delete', {id: quiz.id}) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this quiz?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ quiz.id) }}">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            {% endif %}
        </p>
    </div>

    <h2>Questions</h2>
    
    {% if quiz.questions|length > 0 %}
        {% for question in quiz.questions %}
            <div class="question-card">
                <h3>Question {{ loop.index }}: {{ question.text }}</h3>
                <p class="quiz-meta">
                    Type: {{ question.questionType }} | 
                    Points: {{ question.points }} |
                    Time Limit: {{ question.timeLimit }}s
                    {% if question.mediaUrl %}| Media: <a href="{{ question.mediaUrl }}" target="_blank">View</a>{% endif %}
                </p>
                
                <h4>Answers:</h4>
                <ul class="answer-list">
                    {% for answer in question.answers %}
                        <li class="answer-item {% if answer.isCorrect %}correct{% endif %}">
                            {{ answer.text }}
                            {% if answer.isCorrect %} âœ“{% endif %}
                        </li>
                    {% else %}
                        <li>No answers defined</li>
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
    {% else %}
        <p>No questions have been added to this quiz yet.</p>
    {% endif %}
</div>
{% endblock %}
